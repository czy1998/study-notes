# http

### 简介

HTTP（HyperText Transfer Protocol）一个用来交换超文本文档的简单协议，超文本传输协议

### 各个版本的特点

#### http/1.1——标准化的协议

- `连接`可以`复用`，节省了多次打开 TCP 连接加载网页文档资源的时间。
- 增加`管线化`技术，允许在第一个应答被完全发送之前就发送第二个请求，以降低通信延迟。
- 支持响应分块。
- 引入额外的`缓存控制机制`。
- 引入`内容协商机制`，包括语言、编码、类型等。并允许客户端和服务器之间约定以最合适的内容进行交换。
- 凭借 `Host` 标头，能够使不同域名配置在同一个 IP 地址的服务器上（服务器区分虚拟主机）。

**缺陷**

- 一个 TCP 连接一次只能处理一个请求（阻塞）
- 请求头冗长、重复
- 需要多个 TCP 连接并行加载资源
- 资源加载顺序受限（队头阻塞）
  > 举例：  
  > 页面加载需要 50 个静态资源（图片、CSS、JS）  
  > 浏览器只能为每个域名开 6 个并行连接（Chrome 默认限制）  
  > → 导致排队等待、重复握手、带宽浪费。

#### 超过 15 年的扩展

- **HTTP 用于安全传输**
  - 创建了一个额外的加密传输层：SSL，SSL 在标准化道路上最终成为了 TLS
- **HTTP 用于复杂应用**

  - 一种新的使用 HTTP 的模式被设计出来：`具象状态传输`（representational state transfer） (或者说 REST)

- **放松安全措施——基于当前的 Web 模型** (有点难懂)
  - HTTP 和 Web 安全模型——`同源策略`是互不相关的。
  - 这些年来，已经证实了它如果能通过在特定的约束下`移除一些这个策略的限制`来管的宽松些的话，将会更有用
  - 这些策略导致大量的成本和时间被花费在通过转交到服务端来添加一些新的 HTTP 头来发送。这些被定义在了跨源资源共享（CORS）和内容安全策略（CSP）规范里

#### HTTP/2——为了更优异的表现

- HTTP/2 是`二进制协议`而不是文本协议。不再可读，也不可无障碍的手动创建，改善的优化技术现在可被实施。
- 这是一个`多路复用协议`。并行的请求能在同一个链接中处理，移除了 HTTP/1.x 中顺序和阻塞的约束。
- `压缩了标头`。因为标头在一系列请求中常常是相似的，其移除了重复和传输重复数据的成本。
- 其允许服务器在客户端缓存中填充数据，通过一个叫`服务器推送`的机制来提前请求。

#### HTTP/3——基于 QUIC 的 HTTP

- HTTP/3 有着与 HTTP 早期版本的相同语义，但在传输层部分使用 `QUIC` 而不是 `TCP`
- QUIC 旨在为 HTTP 连接设计更低的延迟。类似于 HTTP/2，它是一个`多路复用协议`，
- 但是 HTTP/2 通过单个 TCP 连接运行，所以在 TCP 层处理的数据包丢失检测和重传可以阻止所有流。
- QUIC 通过 UDP 运行多个流，并为每个流独立实现数据包丢失检测和重传，因此如果发生错误，只有该数据包中包含数据的流才会被阻止。

### 相关概念

#### 内容安全策略（CSP）

> CSP 是浏览器提供的一种安全策略机制，  
> 由服务器通过 HTTP 响应头或 <meta> 标签告知浏览器：  
> 哪些外部资源（脚本、样式、图片等）可以加载或执行，哪些不行。

**作用**

- 防止 XSS（跨站脚本攻击）
- 防止加载恶意外部资源
- 防止内联脚本执行
- 限制数据上报、防止隐私泄露

#### REST（representational state transfer）

- REST 是一种基于 HTTP 的架构风格，是一种设计理念
- 它把网络中的一切视为资源，用统一的 URL 标识，
- 并通过 HTTP 动词（GET/POST/PUT/DELETE）来操作资源。

#### RESTful API

- RESTful API 就是遵循 REST 设计原则的 Web API。
- 语义清晰、可扩展、易调试，是现代 Web 的基础。
