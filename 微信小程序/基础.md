# 基础

## 基本用法

1. 全局配置、局部配置

   - 全局配置: 根目录下的 `app.json` 中设置

   ```json
   {
    // 登记页面
    "pages": ["pages/index/index"],
    // 登记分包页面
    "subPackages": [
        {
        "root": "sec_pages",
        "pages": ["pages/budgetRecord/budgetRecord"]
        }
    ],
    // 声明分包预下载规则
    "preloadRule": {
        // preloadRule 中，key 是页面路径，value 是进入此页面的预下载配置，每个配置有以下几项：
        "pages/index/index": {
        // 在指定网络下预下载，可选值为：
        // all: 不限网络
        // wifi: 仅wifi下预下载
        "network": "all",
        // 进入页面后预下载分包的 root 或 name。__APP__ 表示主包。
        "packages": ["taro"]
        }
    },
    // 底部 tab 栏的表现
    "tabBar": {
        "color": "#454F4E",
        "selectedColor": "#199AB9",
        "list": [
        {
            "pagePath": "pages/index/index",
            "iconPath": "img/tabBar/icon_sy@3x.png",
            "selectedIconPath": "img/tabBar/logo@3x.png",
            "text": "首页"
        },
        {
            "pagePath": "pages/mine/mine",
            "iconPath": "img/tabBar/icon_grzx@3x.png",
            "selectedIconPath": "img/tabBar/select_grzx.png",
            "text": "个人中心"
        }
        ]
    },
    // 小程序接口权限相关设置
    "permission": {
        "scope.userLocation": {
        "desc": "你的位置信息将用于定位功能"
        },
        "scope.writePhotosAlbum": {
        "desc": "将照片保存到相册"
        }
    },
    // 全局自定义组件配置
    // 在 app.json 中声明的自定义组件视为全局自定义组件，在小程序内的页面或自定义组件中可以直接使用而无需再声明。
    // 注1：全局自定义组件会视为被所有页面依赖，会在所有页面启动时进行初始化，影响启动性能且会占用主包大小。
    // 注2：在全局声明使用率低的自定义组件会大幅影响按需注入的效果。
    "usingComponents": {
        "i-toast": "./dist/toast/index"
    },
    // 全局的默认窗口表现
    // 用于设置小程序的状态栏、导航条、标题、窗口背景色。
    "window": {
        "backgroundTextStyle": "light",
        "navigationBarBackgroundColor": "#199ABA",
        "backgroundColor": "#f4f4f4",
        "backgroundColorBottom": "#f4f4f4",
        "navigationBarTextStyle": "white"
    }
    // 指明 sitemap.json 的位置
    // 微信会读取该文件，根据其中的规则决定哪些页面允许被微信索引，从而在微信搜索中展示。
    "sitemapLocation": "sitemap.json",
    // 调用的地理位置相关隐私接口
    // 使用以下8个地理位置相关接口时，需要声明该字段，否则将无法正常使用，此处只列举了2项
    "requiredPrivateInfos": ["chooseLocation", "getLocation"]
    }

   ```

   - 局部配置: 各自页面下的 `page.json` 中设置

   ```json
   {
     // 页面自定义组件配置
     "usingComponents": {
       "van-tabbar": "/vantDist/tabbar/index",
       "van-tabbar-item": "/vantDist/tabbar-item/index"
     },
     // 导航栏标题文字内容
     "navigationBarTitleText": "内部培训助手",
     // 是否开启当前页面下拉刷新
     "enablePullDownRefresh": true,
     // 页面上拉触底事件触发时距页面底部距离，单位为px。
     "onReachBottomDistance": 50,
     // 设置为 true 则页面整体不能上下滚动
     "disableScroll": false,
     // 下拉 loading 的样式，仅支持 dark / light
     "backgroundTextStyle": "dark"
   }
   ```

2. 全局样式、局部样式

   - 全局样式: 根目录下的 `app.wxss` 中设置
   - 局部样式: 各自页面下的 `page.wxss` 中设置

3. 显示变量、设置变量

   - 变量需要双大括号包裹

   ```wxml
   <text>{{msg}}</text>
   ```

   ```js
   this.setData({
     msg: "hello",
   });
   ```

4. getApp()

   - 获取到全局唯一的 App 实例，获取 App 上的`数据`或调用开发者注册在 App 上的`函数`。

   ```js
   // xxx.js
   const appInstance = getApp();
   console.log(appInstance.globalData); // I am global data
   ```

5. getCurrentPages()

   - 获取当前页面栈。通常用于修改上一页的数据，或者调用上一页的方法

   ```js
   var pages = getCurrentPages();
   var prevPage = pages[pages.length - 2]; // 当前页是栈中最后一页，上一页往前推
   if (prevPage.route === "pages/sign/SignIn") {
     const com = prevPage.selectComponent("#sign-in-channel"); //
     com.setData({
       payments,
       totalAmount: getTotalAmount(payments),
     });
   }
   ```

6. selectComponent()
   - 用于获取页面或自定义组件中指定 ID 的子组件实例
   - 通过该方法，父组件可以直接访问子组件的属性和方法，实现父子组件间的交互。
